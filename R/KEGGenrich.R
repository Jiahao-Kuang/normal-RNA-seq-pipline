#' KEGGenrich
#'
#'Analyse RNA-seq data
#' @param GENE_TO_ENRICH gene list generated by IDchange
#' @param CHANGEtoTYPE type of gene
#' @param SPECIES specie
#' @example
#' KEGGenrich(GENE_TO_ENRICH,SPECIES)
KEGGenrich<-function(GENE_TO_ENRICH,SPECIES){
  if (!colnames(GENE_TO_ENRICH$ENTREZID) %in% "ENTREZID") {
    stop("'GENE_TO_ENRICH' ", c("must at least have a col names'ENTREZID'"))
  }
  species_list<-c("HUMAN","MOUSE","RAT")
  if (!SPECIES%in%species_list) {
    ERRORinSPECIES<-paste("input should be one of",paste(species_list,collapse = ","))
    stop('"SPECIES"', ERRORinSPECIES)
  }
  if (SPECIES=="HUMAN") {
    KEGG_database="hsa"
  }
  if (SPECIES=="MOUSE") {
    KEGG_database="mmu"
  }
  if (SPECIES=="RAT") {
    KEGG_database="rno"
  }
  KEGG<-clusterProfiler::enrichKEGG(GENE_TO_ENRICH$ENTREZID,
                                    organism = KEGG_database,
                                    pvalueCutoff = 0.05,#设定p值阈值
                                    qvalueCutoff = 0.05,#设定q值阈值
  )
  KEGG_readable<-DOSE::setReadable(KEGG,
                                   OrgDb = OrgDb,
                                   keyType = "ENTREZID")
  return(KEGG_readable)
}
